{% extends 'base.html.twig' %}

{% block title %}Quiz Details{% endblock %}

{% block body %}
    <style>
        .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
        .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
    </style>

    <div class="example-wrapper">
        <h1>{{ 'quiz_title'|trans({'%prompt%': quiz.prompt}) }}</h1>

        <ul>
            <li>{{ 'quiz_id'|trans }}: {{ quiz.id }}</li>
            <li>{{ 'quiz_prompt'|trans }}: {{ quiz.prompt }}</li>
            <li>{{ 'quiz_user'|trans }}: {{ quiz.user.email }}</li>
        </ul>

        <h2>{{ 'quiz_questions'|trans }}</h2>
        <form method="post" action="{{ path('app_quiz_submit') }}">
            <input type="hidden" name="quiz_id" value="{{ quiz.id }}">
            {% for question in quiz.questions %}
                <div>
                    <h3>{{ question.content }}</h3>
                    <ul>
                        {% for option in question.options %}
                            {% if question.type == constant('App\\Enum\\QuestionType::MULTIPLE') %}
                                <li style="list-style: none">
                                    <input type="checkbox" id="option{{ option.id }}" name="question{{ question.id }}[]" value="{{ option.id }}">
                                    <label for="option{{ option.id }}">{{ option.content }}</label>
                                </li>
                            {% else %}
                                <li style="list-style: none">
                                    <input type="radio" id="option{{ option.id }}" name="question{{ question.id }}" value="{{ option.id }}" required>
                                    <label for="option{{ option.id }}">{{ option.content }}</label>
                                </li>
                            {% endif %}
                        {% endfor %}
                    </ul>
                </div>
            {% endfor %}
            <button type="submit">Submit</button>
        </form>

        <h3>{{ 'random_number_prompt'|trans }}</h3>
        <input type="number" id="numAnswers" min="1">
        <button type="button" onclick="getRandomNumber()">{{ 'get_random_number_button'|trans }}</button>
        <p id="randomNumberResult"></p>
    </div>

    <script>
        const randomNumberApiUrl = "{{ random_number_api_url }}";

        function getRandomNumber() {
            const numAnswers = document.getElementById('numAnswers').value;
            fetch(`${randomNumberApiUrl}${numAnswers}`)
                .then(response => response.json())
                .then(data => {
                    document.getElementById('randomNumberResult').innerText = `{{ 'random_number_result'|trans }}: ${data.random_number}`;
                })
                .catch(error => {
                    console.error('Error fetching random number:', error);
                });
        }
    </script>
{% endblock %}